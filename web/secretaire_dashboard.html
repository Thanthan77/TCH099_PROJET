<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="Cache-Control" content="no-store, no-cache, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />
  <title>Tableau de bord - Secrétaire</title>
  <link rel="stylesheet" href="css/secretaire_dashboard.css">
  <link rel="stylesheet" href="css/surbrillance_horaire.css"/>
  <script src="script/secretaire_dashboard.js" defer></script>
  <script src="script/get_handle_data.js" defer></script>
</head>

<body>

  <header>
    <div class="logo-container">
      <img src="image/logo.png" alt="Logo FIX-SANTÉ" class="logo">
      <h1>Clinique VITALIS – Espace Secrétaire</h1>
    </div>
    <div class="user-menu-container">
      <img src="image/menu.png" alt="Menu" class="user-menu-icon" onclick="toggleUserMenu()" />
      <div class="user-dropdown" id="userDropdown">
        <a href="profile.html" id="btn-profile">Accéder au profil</a>
        <a href="reinitialiser_mdp.html" id="btn-password">Changer mot de passe</a>
        <a href="index.html" id="btn-logout">Se déconnecter</a>

      </div>
    </div>
  </header>

  <nav class="tabs">
    <button onclick="showTab('rdv')">Rendez-vous</button>
    <button onclick="showTab('creation'); attendreEtEnvoyer();">
      Nouveau rendez-vous
    </button>
    <button onclick="showTab('vacances')">Congée</button>
     <button onclick="showTab('horaire')">Horaire</button>
    <button onclick="showTab('patients')">Informations patients</button>
  </nav>

  <main>
    <!-- Section RDV -->
    <section id="rdv" class="tab-content">
      <div class="rdv-header">
        <h2 class="rdv-title">Les rendez-vous</h2>
        <img src="image/filter.png" alt="Filtrer" class="filtre-icon"/>
      </div>

      <div class="rdv-filter hidden" id="filtreSectionRdv">
        <input type="text" id="filtreNomPatientRdv" placeholder="Nom du patient">
        <input type="text" id="filtreNomProRdv" placeholder="Nom du professionnel">
        <select id="filtreServiceRdv">
          <option value="">-- Tous les services --</option>
          <option value="Consultation générale">Consultation générale</option>
          <option value="Suivi de grossesse">Suivi de grossesse</option>
          <option value="Suivi de maladies chroniques">Suivi de maladies chroniques</option>
          <option value="Dépistage ITSS">Dépistage ITSS</option>
          <option value="Vaccination">Vaccination</option>
          <option value="Prélèvement sanguin / test urinaire">Prélèvement sanguin / test urinaire</option>
          <option value="Urgence mineure">Urgence mineure</option>
        </select>
        <input type="date" id="filtreDateRdv" placeholder="Date du rendez-vous">
        <button onclick="filtrerRendezVous()">Rechercher</button>
        <button onclick="reinitialiserFiltreRdv()">Réinitialiser</button>
      </div>

      <table>
        <thead>
          <tr>
            <th>Date</th><th>Heure</th><th>Patient</th><th>Professionnel</th><th>Service</th><th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            
          </tr>
        </tbody>
      </table>
    </section>

    <!-- Section Création de rendez-vous -->
    <section id="creation" class="tab-content hidden">
      <h2>Nouveau Rendez-vous</h2>

      <label>Nom du patient :</label>
      <input type="text" id="nomPatient" autocomplete="off">
      <ul id="listeDeroulantePatients" class="dropdown-patient hidden"></ul>

      <label>Numéro d'assurance maladie :</label>
      <input type="text" id="assurancePatient" oninput="rechercherPatientParAssurance()">

      <label>Service :</label>
      <select id="service" onchange="mettreAJourProfessionnelsSuivi()">
        <option value="">-- Sélectionnez un service --</option>
      </select>

      <label>Professionnel :</label>
      <select id="professionnel" disabled>
        <option value="">-- Sélectionnez un service d'abord --</option>
      </select>

      <label>Date :</label>
      <input type="date" id="date">

      <label>Heure :</label>
      <select id="heure">
        <!-- Les heures seront ajoutées dynamiquement ici -->
      </select>

      <button onclick="creerRendezVous()">Créer le rendez-vous</button>
    </section>

    <!-- Modal de sélection de patient en cas de doublon -->
    <div id="popupSelectionPatient" class="hidden" onclick="fermerPopupPatient()">
      <div class="popup-content" onclick="event.stopPropagation()">
        <h3>Plusieurs patients trouvés</h3>
        <ul id="listePatients"></ul>
        <button onclick="fermerPopupPatient()">Annuler</button>
      </div>
    </div>

    <!-- Section Patients -->
    <section id="patients" class="tab-content hidden">
      <h2>Informations des patients</h2>

      <div class="filtre-header">
        <img src="image/filter.png" alt="Filtrer" class="filtre-icon"/>
      </div>

      <div class="patient-filter hidden" id="filtreSection">
        <input type="text" id="filtrePrenom" placeholder="Prénom">
        <input type="text" id="filtreNom" placeholder="Nom">
        <input type="date" id="filtreDateNaissance">
        <input type="text" id="filtreAssurance" placeholder="Carte d'assurance maladie">
        <button onclick="filtrerPatients()">Rechercher</button>
        <button onclick="reinitialiserFiltres()">Réinitialiser</button>
      </div>

      <table>
        <thead>
          <tr>
            <th>Prénom</th><th>Nom</th><th>Date de naissance</th><th>Numéro d'assurance maladie</th><th>Numéro de téléphone</th><th>Courriel</th>
          </tr>
        </thead>
        <tbody id="table-patients"></tbody>
      </table>
    </section>

    <!-- Modal de modification de rendez-vous -->
    <div id="popupModification" class="hidden" onclick="fermerPopup()">
      <div class="popup-content" onclick="event.stopPropagation()">
        <h3>Modifier le rendez-vous</h3>

        <label for="popupNomPatient">Nom :</label>
        <input id="popupNomPatient" type="text" disabled>

        <label for="popupAssurancePatient">Numéro d'assurance maladie :</label>
        <input id="popupAssurancePatient" type="text" disabled>

        <label for="popupService">Service :</label>
        <select id="popupService"></select>

        <label for="popupProfessionnel">Professionnel :</label>
        <select id="popupProfessionnel"></select>

        <label for="popupDate">Jour :</label>
        <input type="date" id="popupDate">

        <label for="popupHour">Heure :</label>
        <select id="popupHour" type="time">

        <input type="hidden" id="popupNumRdv">

        <input type="hidden" id="popupDure">

        <button onclick="validerModification()">Valider</button>
        <button onclick="fermerPopup()">Annuler</button>
      </div>
    </div>


    <!-- Vacances -->
    <section id="vacances" class="tab-content hidden">
      <h2>Demande de vacances</h2>
      <label for="date-debut">Date de début :</label>
      <input type="date" id="date-debut" />
      <label for="date-fin">Date de fin :</label>
      <input type="date" id="date-fin" />
      <button id="btn-demande-vacances" type="button">Envoyer la demande</button>
      <div id="erreur-vacances" style="margin-top: 10px;"></div>

    <h2>Liste de mes demandes</h2>
  <table id="table-vacances">
    <thead>
      <tr>
        <th>Nom</th>
        <th>Date début</th>
        <th>Date fin</th>
        <th>Statut</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</section>




  <!-- Section Horaire -->
    <section id="horaire" class="tab-content hidden">
      <h2>Horaire</h2>
      <table>
        <thead>
          <tr>
            <th>Nom</th>
            <th>Jours</th>
            <th>Heure</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </section>

  </main>
</body>
</html>
